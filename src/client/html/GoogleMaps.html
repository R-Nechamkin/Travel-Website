<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Google Maps</title>
    <link href = "../../Map%20Stylesheet.css" rel = "stylesheet">
      <script src = "https://maps.googleapis.com/maps/api/js?key=AIzaSyCDOR2kWa1A79F6iLOtuExM5W-TKVXHMrA&callback=initMap"
    async defer></script>

</head>
<body>
    It's a map!
  <div id = "map" style = "width: 100%; height: 400px;"></div>


<!-- General Map-->
  <script>
    initMap();
      <!-- Let's try getting from place name-->
    function  initMap(){

        const latitude = 40.84;
        const longitude = -74;

        displayMap(latitude, longitude);
        /*
        const apiKey = 'AIzaSyCDOR2kWa1A79F6iLOtuExM5W-TKVXHMrA';
        const placeName = '40%20Crescent%20Avenue%20Passaic%20NJ';
        const geocodeURL = 'https://maps.googleapis.com/maps/api/geocode/json?address=40%20Crescent%20Avenue%20Passaic%20NJ&key=AIzaSyCDOR2kWa1A79F6iLOtuExM5W-TKVXHMrA';
        document.write("in init map");
        fetch('https://maps.googleapis.com/maps/api/geocode/json?address=40%20Crescent%20Avenue%20Passaic%20NJ&key=AIzaSyCDOR2kWa1A79F6iLOtuExM5W-TKVXHMrA')
            .then((api) => {
                 api.json();
            })
            .then((data) => {
                useAPI(data);
            })
            .catch((error)=> {
                document.write('Error making the Geocoding API request: ', error);
            });
        function useAPI(data){
            document.write(data);
                if (data.status === 'OK' && data.results.length > 0){
                    document.write(data);
                    const location = data.results[0].geometry.location;
                    const latitude = location.lat;
                    const longitude = location.lng;

                    displayMap(latitude, longitude);
                } else{
                    document.write("Geocoding request failed or no results found for this place name");
                }
        }
            /*
         fetch('https://maps.googleapis.com/maps/api/geocode/json?address=40%20Crescent%20Avenue%20Passaic%20NJ&key=AIzaSyCDOR2kWa1A79F6iLOtuExM5W-TKVXHMrA')
                .then(api => api.json())
                    .then(data => {
                        if (data.result === "success") {
                            let rate = data.conversion_rate;
                            let newAmount = (original * rate.toFixed(2));
                             $('#result').attr("value", newAmount);
                        }
                        else{
                            // I should display this error message somewhere on the HTML but for now it's being sent
                                // to the console
                            console.log("Cannot find conversion rates right now.")
                        }
                    })
                .catch(error => {
                    // I should display this error message somewhere on the HTML but for now it's being sent
                                // to the console
                    console.log("Cannot connect to server")
                })

        /*displayMap(40.8478746, -74.13869560000001);*/

        function displayMap(lat, long) {
            const map = new google.maps.Map(document.getElementById("map"), {
                center: {lat: lat, lng: long},
                zoom: 12,
            });
        }
        const marker = new google.maps.Marker({
          position: {lat:latitude, lng: longitude},
          map: map,
          title: 'Place 1'

      });
      }
  </script>


</body>
</html>